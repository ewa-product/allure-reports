{"uid":"46d42a1848c20e5","name":"test_get_delivery_addresses_permissions[authorize_partner]","fullName":"tests.delivery.test_02_get_delivery_address#test_get_delivery_addresses_permissions","historyId":"073d259dac03cdb5dad9578fdccda774","time":{"start":1744416733254,"stop":1744416733853,"duration":599},"description":"Тест: проверка получения адресов","descriptionHtml":"<p>Тест: проверка получения адресов</p>\n","status":"skipped","statusMessage":"XFAIL https://ru.yougile.com/team/01c2a92f1328/#IT-628\n\nAssertionError: Поле delivery_price отсутствует в ответе","statusTrace":"api_client = <api_tests.utils.api_client.APIClient object at 0x7f48c70eecd0>\nauthorize_func = <function authorize_partner at 0x7f48c717e480>\n\n    @pytest.mark.smoke\n    @pytest.mark.parametrize(\n        \"authorize_func\",\n        [\n            authorize_client,\n            authorize_partner,\n            authorize_admin\n        ]\n    )\n    @pytest.mark.xfail(reason = \"https://ru.yougile.com/team/01c2a92f1328/#IT-628\")\n    def test_get_delivery_addresses_permissions(api_client, authorize_func):\n        \"\"\"Тест: проверка получения адресов\"\"\"\n        authorize_func(api_client)\n        payload = create_address_payload()\n        response = api_client.post(\"/delivery/user_address\", json=payload)\n        address_id = response[\"id\"]\n        payload = {\n            \"pagination\": {\n                \"page\": 0,  # Первая страница (начинается с 0)\n                \"size\": 10,  # Количество объектов на странице\n                \"total\": 100  # Общее количество объектов\n            }\n        }\n        response = api_client.post(\"/delivery/user_address/list\", json=payload)\n        assert_response_status_OK(api_client.last_response.status_code, 200)\n        for address in response[\"addresses\"]:\n>           assert_delivery_address_fields(address)\n\napi_tests/tests/delivery/test_02_get_delivery_address.py:35: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \napi_tests/utils/asserts.py:170: in assert_delivery_address_fields\n    assert_presence_of_all_fields(response, expected_fields, optional_fields)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nresponse = {'Iin': '990101300123', 'city_id': 23, 'city_name': 'Москва', 'comment': 'Позвоните за 74304 минут до доставки', ...}\nexpected_fields = ['country_id', 'delivery', 'email', 'id', 'name', 'phone', ...]\noptional_fields = ['region_id', 'region_name', 'city_name', 'city_id', 'comment', 'Iin']\n\n    def assert_presence_of_all_fields(response, expected_fields, optional_fields=[]):\n        if isinstance(response, str):  # Если response строка, парсим JSON\n            try:\n                response = json.loads(response)\n            except json.JSONDecodeError:\n                assert False, f\"Ответ не является валидным JSON: {response}\"\n        assert isinstance(response, dict), f\"Ожидался словарь, но получен {type(response)}: {response}\"\n        for field in expected_fields:\n>           assert field in response, f\"Поле {field} отсутствует в ответе\"\nE           AssertionError: Поле delivery_price отсутствует в ответе\n\napi_tests/utils/asserts.py:13: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"api_client","time":{"start":1744416732335,"stop":1744416732335,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"api_client::0","time":{"start":1744416743681,"stop":1744416743681,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"@pytest.mark.xfail(reason='https://ru.yougile.com/team/01c2a92f1328/#IT-628')"},{"name":"tag","value":"smoke"},{"name":"parentSuite","value":"tests.delivery"},{"name":"suite","value":"test_02_get_delivery_address"},{"name":"host","value":"fv-az1937-160"},{"name":"thread","value":"2010-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.delivery.test_02_get_delivery_address"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"authorize_func","value":"<function authorize_partner at 0x7f48c717e480>"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":["@pytest.mark.xfail(reason='https://ru.yougile.com/team/01c2a92f1328/#IT-628')","smoke"]},"source":"46d42a1848c20e5.json","parameterValues":["<function authorize_partner at 0x7f48c717e480>"]}